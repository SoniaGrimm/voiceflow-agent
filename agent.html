<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Voiceflow Agent</title>
  </head>
  <body>
    <script type="module">
      import ChatWidget from 'https://cdn.voiceflow.com/widget/bundle.mjs';

      // 1) Récupérer les paramètres dans l’URL
      const params = new URLSearchParams(window.location.search);
      const agent = params.get('agent') || '1';          // ton paramètre agent déjà existant
      const userEmail = params.get('user_email') || 'guest'; // ajouté depuis Adalo

      // 2) Log pour vérifier que ça marche (ouvre la console du navigateur)
      console.log("Agent ID:", agent);
      console.log("User email reçu:", userEmail);

      // 3) Initialiser Voiceflow avec userEmail comme userID
      ChatWidget.init({
        verify: { projectID: 'YOUR_PROJECT_ID' },   // ← remplace par ton vrai projectID Voiceflow
        url: 'https://general-runtime.voiceflow.com',
        versionID: 'production',
        userID: userEmail   // ← la clé stable pour reconnaître l’utilisateur
      }).then(widget => {
        console.log("Widget Voiceflow chargé avec userID:", userEmail);
      });
    </script>
  </body>
</html>
